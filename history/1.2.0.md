# 版本 1.2.0

**发布日期**: 2026-01-22

## 新功能

### 双人联机模式 (V0/V1)
- 新增双人联机功能，支持两名玩家在同一房间内协作游戏
- 实现 Host 权威架构：只有房主运行世界逻辑（敌人、子弹、经验球等）
- 使用 Supabase Realtime (Presence + Broadcast) 实现实时通信

### 房间系统
- 支持创建和加入房间
- 6 位随机房间代码
- 房间代码一键复制功能
- 玩家列表实时更新
- Host 自动选举（最早加入的玩家为 Host）

### 独立玩家成长
- 每个玩家拥有独立的 PlayerState（位置、血量、等级、经验、技能）
- 技能效果只作用于选择该技能的玩家
- 子弹携带 ownerId 和 ownerStatsSnapshot，确保伤害正确归属

### 消息协议
- InputMsg: 客户端输入消息 (30Hz)
- SnapshotMsg: 世界快照消息 (15Hz)
- SkillPickMsg: 技能选择消息
- EventMsg: 游戏事件消息

### UI 改进
- 主页新增"多人联机"入口按钮
- 新增联机大厅界面（创建/加入房间）
- 新增等待房间界面（玩家列表、房间代码）
- 双人 HUD 显示两个玩家的状态
- 连接状态指示器

## 新增文件

- `pages/multiplayer.html` - 联机游戏页面
- `css/multiplayer.css` - 联机界面样式
- `js/multiplayer/room.js` - 房间管理模块
- `js/multiplayer/protocol.js` - 消息协议模块
- `js/multiplayer/multiplayerGameFactory.js` - 多人游戏工厂
- `js/multiplayer/multiplayerTick.js` - 联机游戏主循环
- `js/multiplayer/lobby.js` - 大厅界面逻辑

## 修改文件

- `index.html` - 启用多人联机按钮
- `version.txt` - 更新版本号

## 技术说明

本版本实现了文档中描述的 V0 和 V1 功能：
- V0: 两个浏览器同步敌人/子弹/掉落，能看到对方移动
- V1: 两人 build 不同，子弹伤害不同但命中同一敌人

后续版本将实现：
- V2: 性能优化（增量快照、视野裁剪）
- V3: Host 迁移（断线重连）
